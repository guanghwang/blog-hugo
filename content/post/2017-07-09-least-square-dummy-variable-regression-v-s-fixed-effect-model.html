---
title: Least Square Dummy Variable Regression V.S. Fixed Effect Model
author: Guanghua Wang
date: '2017-07-09'
slug: least-square-dummy-variable-regression-v-s-fixed-effect-model
categories: ["R Learning Notes"]
tags: ["R regression"]
summary: The fixed effect model is much faster than LSDV.
---





<!-- BLOGDOWN-BODY-BEFORE -->

<!-- /BLOGDOWN-BODY-BEFORE -->

<p>In the panle regression setup, the coefficients of continuous variables in the Least Square Dummy Variable model is identical to that in the Fixed Effect Model. However, the computing time needed is much less in the Fixed Effect Model than the time in the Least Square Dummy Variable Model.</p>
<pre class="r"><code>if (!require(plm)) install.packages(&quot;plm&quot;)</code></pre>
<pre><code>## Loading required package: plm</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre class="r"><code>library(plm)
if (!require(broom)) install.packages(&quot;broom&quot;)</code></pre>
<pre><code>## Loading required package: broom</code></pre>
<pre class="r"><code>library(broom)
data(package = &quot;plm&quot;)</code></pre>
<div id="data-desciption" class="section level2">
<h2>Data Desciption</h2>
<p>I use <code>Males</code> dataset as an example.</p>
<pre class="r"><code>data(Males, package = &quot;plm&quot;)
summary(Males)</code></pre>
<pre><code>##        nr             year          school          exper       
##  Min.   :   13   Min.   :1980   Min.   : 3.00   Min.   : 0.000  
##  1st Qu.: 2329   1st Qu.:1982   1st Qu.:11.00   1st Qu.: 4.000  
##  Median : 4569   Median :1984   Median :12.00   Median : 6.000  
##  Mean   : 5262   Mean   :1984   Mean   :11.77   Mean   : 6.515  
##  3rd Qu.: 8406   3rd Qu.:1985   3rd Qu.:12.00   3rd Qu.: 9.000  
##  Max.   :12548   Max.   :1987   Max.   :16.00   Max.   :18.000  
##                                                                 
##  union         ethn      married    health          wage       
##  no :3296   other:3176   no :2446   no :4286   Min.   :-3.579  
##  yes:1064   black: 504   yes:1914   yes:  74   1st Qu.: 1.351  
##             hisp : 680                         Median : 1.671  
##                                                Mean   : 1.649  
##                                                3rd Qu.: 1.991  
##                                                Max.   : 4.052  
##                                                                
##                              industry   
##  Manufacturing                   :1231  
##  Trade                           :1169  
##  Professional_and_Related Service: 333  
##  Business_and_Repair_Service     : 331  
##  Construction                    : 327  
##  Transportation                  : 286  
##  (Other)                         : 683  
##                                occupation            residence   
##  Craftsmen, Foremen_and_kindred     :934   rural_area     :  85  
##  Operatives_and_kindred             :881   north_east     : 733  
##  Service_Workers                    :509   nothern_central: 964  
##  Clerical_and_kindred               :486   south          :1333  
##  Professional, Technical_and_kindred:453   NA&#39;s           :1245  
##  Laborers_and_farmers               :401                         
##  (Other)                            :696</code></pre>
<pre class="r"><code>class(Males)</code></pre>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<p>In the <code>Males</code> dataset, <code>nr</code> represents the respondents id, and <code>year</code> is the survey year. This dataset is a panel data set.</p>
</div>
<div id="lsdv" class="section level2">
<h2>LSDV</h2>
<p>In the following comparison, I study the relationship between experience and wage. <span class="math inline">\(\log(wage) = \alpha + \beta exp + \gamma exp^2 + \theta Controls\)</span> where the controls include <code>union</code>, <code>ethnicity(ethn)</code>, <code>health</code> and <code>married</code>.</p>
<pre class="r"><code>t &lt;- proc.time()
lsdv &lt;- lm(
  log(wage) ~ exper + I(exper^2) + I(as.integer(union)) + ethn + health + married + factor(nr),
  data = Males,
  subset = wage &gt;= 1
)</code></pre>
<pre><code>## Warning in log(wage): NaNs produced</code></pre>
<pre class="r"><code>lsdv.time &lt;- proc.time() - t
print(lsdv.time)</code></pre>
<pre><code>##    user  system elapsed 
##   1.396   0.024   1.420</code></pre>
<pre class="r"><code>lsdv.result &lt;- tidy(lsdv)
dim(lsdv.result)</code></pre>
<pre><code>## [1] 549   5</code></pre>
<p>In the LSDV model, the final result includes a set of individual dummies.</p>
<pre class="r"><code>head(lsdv.result)</code></pre>
<pre><code>##                   term     estimate    std.error statistic      p.value
## 1          (Intercept)  0.207729300 0.0527951188  3.934631 8.496559e-05
## 2                exper  0.050083076 0.0034919278 14.342529 2.330711e-45
## 3           I(exper^2) -0.001704741 0.0002482169 -6.867948 7.692773e-12
## 4 I(as.integer(union))  0.037940394 0.0078563432  4.829269 1.429904e-06
## 5            ethnblack  0.261543512 0.0703569468  3.717380 2.044951e-04
## 6             ethnhisp  0.171236478 0.0704786977  2.429620 1.516534e-02</code></pre>
</div>
<div id="fixed-effect-model" class="section level2">
<h2>Fixed Effect Model</h2>
<pre class="r"><code>Males.panel &lt;- plm.data(Males, indexes = c(&quot;nr&quot;, &quot;year&quot;))
t &lt;- proc.time()
fixed_effect &lt;- plm(
  log(wage) ~ exper + I(exper^2) + I(as.integer(union)) + ethn + health + married,
  data = Males.panel,
  subset = wage &gt;= 1,
  model = &quot;within&quot;
)</code></pre>
<pre><code>## Warning in log(wage): NaNs produced</code></pre>
<pre class="r"><code>fixed_effect.time &lt;- proc.time() - t
print(fixed_effect.time)</code></pre>
<pre><code>##    user  system elapsed 
##   0.072   0.000   0.068</code></pre>
<pre class="r"><code>fixed_effect.result &lt;- tidy(fixed_effect)
dim(fixed_effect.result)</code></pre>
<pre><code>## [1] 5 5</code></pre>
<p>In the fixed effect model, we only have 5 coefficients because the time-invariant variable(<code>ethn</code>) is cancalled out in the regression.</p>
<pre class="r"><code>head(fixed_effect.result)</code></pre>
<pre><code>##                   term     estimate    std.error  statistic      p.value
## 1                exper  0.050083076 0.0034919278 14.3425289 2.330711e-45
## 2           I(exper^2) -0.001704741 0.0002482169 -6.8679477 7.692773e-12
## 3 I(as.integer(union))  0.037940394 0.0078563432  4.8292689 1.429904e-06
## 4            healthyes  0.004980649 0.0195340488  0.2549727 7.987594e-01
## 5           marriedyes  0.013462863 0.0073480076  1.8321787 6.701093e-02</code></pre>
</div>
<div id="comparison" class="section level2">
<h2>Comparison</h2>
<pre class="r"><code>fixed_effect.result[,2:4] - lsdv.result[2:(nrow(fixed_effect.result) + 1),2:4]</code></pre>
<pre><code>##        estimate     std.error     statistic
## 1 -2.373102e-15 -1.960238e-16  1.261213e-13
## 2  7.806256e-18 -2.331035e-18 -3.286260e-14
## 3  7.563394e-16  8.153200e-17  4.618528e-14
## 4 -2.565629e-01 -5.082290e-02 -3.462407e+00
## 5 -1.577736e-01 -6.313069e-02 -5.974416e-01</code></pre>
<p>The results of continuous variables are (almost) numerically identical. However, the results of dummy variables are different.</p>
<pre class="r"><code>print(lsdv.time)</code></pre>
<pre><code>##    user  system elapsed 
##   1.396   0.024   1.420</code></pre>
<pre class="r"><code>print(fixed_effect.time)</code></pre>
<pre><code>##    user  system elapsed 
##   0.072   0.000   0.068</code></pre>
<pre class="r"><code>lsdv.time - fixed_effect.time</code></pre>
<pre><code>##    user  system elapsed 
##   1.324   0.024   1.352</code></pre>
<pre class="r"><code>lsdv.time[3] / fixed_effect.time[3]</code></pre>
<pre><code>##  elapsed 
## 20.88235</code></pre>
<p>In this example, fixed effect model is 13 times faster than LSDV. Notice the individuals in my sample is 545. As individuals increases, the computing time increase dramatically. (The X matrice increases accordingly).</p>
</div>
